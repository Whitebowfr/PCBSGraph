<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCBS Graph v0.6.2</title>
    <link rel="icon" type="image/png" href="https://img.icons8.com/flat_round/64/000000/bar-chart--v1.png" />
    <style>
        body {
            background-color: rgb(80, 80, 80);
            scroll-behavior: smooth;
        }
        
        #myChart {
            cursor: pointer
        }
    </style>
</head>

<body>
    <script src="Chart.bundle.min.js"></script>

    <script src="JS/graph.js"></script>
    <script src="JS/main.js"></script>

    <div id="divCPUGraph" class="main" style="width: 100%; padding-bottom: 50px;">
        <div id="inputs" style="position: fixed; background-color: rgb(80, 80, 80); top: 0px; width: 100%; height: 54px; border-bottom: 1px solid gray;">
            <select id="sort" onchange="updateGraph(true)">
                <option value="true">descending</option>
                <option value="false">ascending</option>
            </select>
            <select id="type" onchange="GRAPHupdateDropdown(this.value), updateGraph(true)">
                <option value="cpus">CPUs</option>
                <option value="gpus">GPUs</option>
                <option value="ram">RAM</option>
                <option value="mobos">Motherboards</option>
                <option value="storage">Storage</option>
            </select>
            <select id="sortType" onchange="updateGraph(true)">
            </select>
            <input type="button" value="Refresh" onclick="updateGraph(true)">
            <div id="customCPU" style="display: inline-block;">
                <input type="number" placeholder="frequency">
                <input type="button" value="Store" onclick="GRAPHstore(this.previousElementSibling.value); updateGraph(false)">
                <input type="number" placeholder="RAM speed" id="ram" oninput="updateGraph(false)">
            </div>
            <input type="checkbox" id="logarithmicCheck" checked title="Enable logarithmic scale" onclick="updateGraph(true)">
            <input type="checkbox" id="autoUpdateInputs" title="Disable auto-updating of the chart (for performance)">
            <input type="checkbox" id="enableHEM" title="Show HEM Parts" checked onclick="updateGraph(false)">
            <input type="button" id="enableFilters" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'inline-block' : 'none';" value="Show filters">
            <div id="filters" style="background-color: white; border: 3px solid black; border-radius: 1px 1px 1px 1px; display: inline-block; position: absolute; margin-left: 3px;">
                <span style="color: black">Filters :</span>
                <select id="sortTypeFilter">
                </select>
                <select id="sortOrderFilter">
                    <option value="==">=</option>
                    <option value=">" selected>></option>
                    <option value="<"><</option>
                </select>
                <input type="number" placeholder="value" oninput="updateGraph(false)" id="filterValue">
                </br>
                <select id="sortTypeFilterBis" style="margin-left: 55px">
                </select>
                <select id="sortOrderFilterBis">
                    <option value="==">=</option>
                    <option value=">">></option>
                    <option value="<" selected><</option>
                </select>
                <input type="number" placeholder="second value (optional)" oninput="updateGraph(false)" id="filterValueBis">
            </div>
            <input type="button" value="To top" style="float: right; margin-right: 10px; margin-left: 5px; margin-top: 2px;" id="scrollToTopBtn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
            <input type="button" value="&#8593" style="float: right; margin-top: 2px;" id="scrollToPrevious">
            <input type="button" value="&#8595" style="float: right; margin-top: 2px;" id="scrollToNext">
            <p style="float: right; margin: 2px 10px 0 0; color: rgb(175, 171, 171)" id="scrollNumberIndic">0 / 517</p>
            <input type="text" id="search" placeholder="search input" oninput="scrollToSearch()" style="float: right; margin-right: 10px; margin-top: 2px;">
        </div>
        <div id="test" style="margin-top: 50px;">
            <canvas id="myChart">
            </canvas>
        </div>
    </div>
    <input type="button" id="backButton" style="width: 7%; height: 5%; display: none;" onclick="goBack('yes')" value="Back">
    <div id="divPartShower" style="display: none;padding: 10px;width: 70%; border: 3px solid black; border-radius: 10px 10px 10px 10px; margin: 0 auto; text-align: center; background-color: lightgray;">
    </div>
    <script>
        var myChart
        var legendBase = [] //set to global scope
        sessionStorage.clear()
        sessionStorage.setItem("freq", "[]")
        GRAPHupdateDropdown("cpus");
        document.getElementById("myChart").addEventListener("click", function(e) {
            var spaceFromTop = window.pageYOffset + document.getElementById("myChart").getBoundingClientRect().top
            var y = e.pageY - spaceFromTop //get Y click position on the graph instead of the page
            if (y <= myChart.boxes[0].height) {
                return false
            } //if clicked on the legend
            var tickNumber = Math.round(y / (myChart.boxes[3].height / myChart.boxes[3].ticks.length))
            if (type.value == "gpus") {
                tickNumber -= 2 //dis is because the legend on the gpus is 2 lines high I think (not sure but it works)
            } else {
                tickNumber -= 1
            }
            var tickClicked = myChart.boxes[3].ticks[tickNumber]
            document.getElementById("divCPUGraph").style.display = "none"
            document.getElementById("divPartShower").style.display = "block"
            document.getElementById("backButton").style.display = "block"
            window.addEventListener("keyup", function(e) {
                goBack(e)
            })
            showPartDetails(tickClicked)
        })
        window.addEventListener('scroll', scrollToSearch)
    </script>
</body>

</html>